<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Build, test and deploy .NET apps with Vagrant and Docker - Dev&Ops</title>
<meta name=description content="On a resent project at work we build a cross-platform chat-application with Xamarin and SignalR. The SignalR-hub was to find it&rsquo;s home on a Linux-server, given ASP.NETs new found love for other platforms than Windows and IIS. We had limited time and the back-end guys were developing the hub in Visual Studio. To help them make sure the code they wrote would be Mono-compatible (and easy to deploy for testing), I turned to my two favorite pieces of open source technology: Vagrant and Docker.">
<meta name=author content="Andreas Mosti">
<link rel="preload stylesheet" as=style href=https://andmos.github.io/blog.amosti.net/app.min.css>
<link rel=preload as=image href=https://andmos.github.io/blog.amosti.net/theme.png>
<link rel=preload as=image href=https://andmos.github.io/blog.amosti.net/twitter.svg>
<link rel=preload as=image href=https://andmos.github.io/blog.amosti.net/github.svg>
<link rel=icon href=https://andmos.github.io/blog.amosti.net/favicon.ico>
<link rel=apple-touch-icon href=https://andmos.github.io/blog.amosti.net/apple-touch-icon.png>
<meta name=generator content="Hugo 0.92.2">
<meta property="og:title" content="Build, test and deploy .NET apps with Vagrant and Docker">
<meta property="og:description" content="On a resent project at work we build a cross-platform chat-application with Xamarin and SignalR. The SignalR-hub was to find it&rsquo;s home on a Linux-server, given ASP.NETs new found love for other platforms than Windows and IIS. We had limited time and the back-end guys were developing the hub in Visual Studio. To help them make sure the code they wrote would be Mono-compatible (and easy to deploy for testing), I turned to my two favorite pieces of open source technology: Vagrant and Docker.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://andmos.github.io/blog.amosti.net/build-test-and-deploy-net-apps-with-vagrant-and-docker/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2015-03-03T19:26:57+00:00">
<meta property="article:modified_time" content="2015-03-03T19:26:57+00:00">
<meta itemprop=name content="Build, test and deploy .NET apps with Vagrant and Docker">
<meta itemprop=description content="On a resent project at work we build a cross-platform chat-application with Xamarin and SignalR. The SignalR-hub was to find it&rsquo;s home on a Linux-server, given ASP.NETs new found love for other platforms than Windows and IIS. We had limited time and the back-end guys were developing the hub in Visual Studio. To help them make sure the code they wrote would be Mono-compatible (and easy to deploy for testing), I turned to my two favorite pieces of open source technology: Vagrant and Docker."><meta itemprop=datePublished content="2015-03-03T19:26:57+00:00">
<meta itemprop=dateModified content="2015-03-03T19:26:57+00:00">
<meta itemprop=wordCount content="291">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Build, test and deploy .NET apps with Vagrant and Docker">
<meta name=twitter:description content="On a resent project at work we build a cross-platform chat-application with Xamarin and SignalR. The SignalR-hub was to find it&rsquo;s home on a Linux-server, given ASP.NETs new found love for other platforms than Windows and IIS. We had limited time and the back-end guys were developing the hub in Visual Studio. To help them make sure the code they wrote would be Mono-compatible (and easy to deploy for testing), I turned to my two favorite pieces of open source technology: Vagrant and Docker.">
</head>
<body class=not-ready data-menu=true>
<header class=header>
<p class=logo>
<a class=site-name href=https://andmos.github.io/blog.amosti.net>Dev&Ops</a><a class=btn-dark></a>
</p>
<script>let bodyClx=document.body.classList,btnDark=document.querySelector('.btn-dark'),sysDark=window.matchMedia('(prefers-color-scheme: dark)'),darkVal=localStorage.getItem('dark'),setDark=a=>{bodyClx[a?'add':'remove']('dark'),localStorage.setItem('dark',a?'yes':'no')};setDark(darkVal?darkVal==='yes':sysDark.matches),requestAnimationFrame(()=>bodyClx.remove('not-ready')),btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark'))),sysDark.addEventListener('change',a=>setDark(a.matches))</script>
<nav class=menu>
<a href=/blog.amosti.net/about/>About Andreas</a>
</nav>
<nav class=social>
<a class=twitter style=--url:url(./twitter.svg) href=https://twitter.com/amostii target=_blank></a>
<a class=github style=--url:url(./github.svg) href=https://github.com/andmos target=_blank></a>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-title>
<p>
<time>Mar 3, 2015</time>
<span>Andreas Mosti</span>
</p>
<h1>Build, test and deploy .NET apps with Vagrant and Docker</h1>
</header>
<section class=post-content><p>On a resent project at work we build a cross-platform chat-application with <a href=www.xamarin.com>Xamarin</a> and <a href=http://signalr.net/>SignalR</a>.
The SignalR-hub was to find it&rsquo;s home on a Linux-server, given ASP.NETs new found love for other platforms than Windows and IIS.
We had limited time and the back-end guys were developing the hub in Visual Studio. To help them make sure the code they wrote would be Mono-compatible (and easy to deploy for testing), I turned to my two favorite pieces of open source technology: <a href=https://www.vagrantup.com/>Vagrant</a> and <a href=https://www.docker.com/>Docker</a>.</p>
<p>###The code
First, I wrote a simple Dockerfile based on the latest Mono-baseimage that adds the code and runs xbuild in the build-process. When the container is run without parameters, it deploys the server.</p>
<pre><code>FROM mono:latest
ADD SignalRServer SignalRServer
RUN xbuild /SignalRServer/SignalRServer.sln

EXPOSE 8080

CMD mono /SignalRServer/SignalRServer.LocalWebServer/bin/Debug/SignalRServer.LocalWebServer.exe
</code></pre>
<p>To automate this process, a simple script&mldr;</p>
<pre><code># /bin/bash
sudo docker build -t dirc/signalrhub /vagrant/
sudo docker run -p 8080:8080 -td dirc/signalrhub
</code></pre>
<p>&mldr;before we finally spin up a VM via this Vagrantfile and <code>vagrant up</code>.</p>
<pre><code># -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant::Config.run do |config|

  config.vm.box = &quot;virtualUbuntu64&quot;
  config.vm.box_url = &quot;http://files.vagrantup.com/precise64.box&quot;

  config.vm.provision :shell, :inline =&gt; &quot;sudo apt-get update&quot;
  config.vm.provision :shell, :inline =&gt; &quot;sudo apt-get install curl -y&quot;
  config.vm.provision :shell, :inline =&gt; &quot;curl -s https://get.docker.io/ubuntu/ | sudo sh &gt; /dev/null 2&gt;&amp;1&quot;
  config.vm.provision :shell, :inline =&gt; &quot;/vagrant/buildAndDeploySignalRHub&quot;
  config.vm.forward_port 8080, 8080

  end

  Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.provider :virtualbox do |virtualbox|
  virtualbox.customize [&quot;modifyvm&quot;, :id, &quot;--memory&quot;, &quot;1024&quot;]
  end
  end
</code></pre>
<p>Thats it! With a simple <code>vagrant up</code> we get an Ubuntu VM, Docker installed, the code compiled and the hub deployed, and is available at <code>http://localhost:8080</code>.
When the Hub is finished the Docker-container can easily be moved to the production server. If the Windows-guys uses code that breaks the Mono-compability, it is easily discovered.</p>
</section>
<nav class=post-nav>
<a class=prev href=https://andmos.github.io/blog.amosti.net/how-i-read/><span>←</span><span>How I Read</span></a>
<a class=next href=https://andmos.github.io/blog.amosti.net/self-hosted-http-service-in-c-with-nancy-and-topshelf/><span>Self-hosted HTTP service in C# with Nancy and TopShelf</span><span>→</span></a>
</nav>
</article>
</main>
<footer class=footer>
<p>&copy; 2022 <a href=https://andmos.github.io/blog.amosti.net>Dev&Ops</a></p>
<p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p>
<p>
<a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.1</a>
</p>
</footer>
</body>
</html>